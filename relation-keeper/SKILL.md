---
name: relation-keeper
description: |
  è®°å½•å’ŒæŸ¥è¯¢ä½ çš„ç¤¾äº¤å…³ç³»ã€‚ç”¨äºï¼š(1) è®°å½•äººç‰©è‚–åƒï¼ˆæ€§åˆ«ã€å‡ºç”Ÿå¹´/æ—¥ã€å®¶åº­åœ°å€ã€æ‰‹æœºã€å–œå¥½ç­‰ï¼‰ï¼Œ
  (2) å½’æ¡£è¿‡å»å…±åŒç»å†ï¼ˆçº¦ä¼šã€åƒé¥­ã€æ¸¸ç©ç­‰ï¼‰ï¼Œ(3) æŒ‰äººæŸ¥è¯¢å†å²äº‹ä»¶ã€‚
metadata:
  openclaw:
    slug: relation-keeper
    emoji: "ğŸ‘¥"
    requires: {}
    install:
      - id: "init-data"
        kind: "run"
        label: "åˆå§‹åŒ–æ•°æ®ç›®å½•"
        command: "npm run init"
---

# å…³ç³»è®°å½• Relation Keeper

è®°å½•å’ŒæŸ¥è¯¢ä½ çš„ç¤¾äº¤å…³ç³»ç½‘ç»œï¼š**è‚–åƒç»´æŠ¤**ã€**å†å²å½’æ¡£**ã€**äººç‰©æŸ¥è¯¢**ã€‚

---

## ä¸€ã€æ•°æ®å­˜å‚¨

æ•°æ®å­˜å‚¨åœ¨ `$RELATION_KEEPER_DATA` æŒ‡å‘çš„ç›®å½•ï¼›æœªè®¾ç½®æ—¶ä½¿ç”¨å½“å‰ skill ç›®å½•ä¸‹çš„ `data/` æ–‡ä»¶å¤¹ã€‚

### 1.1 äººç‰©è‚–åƒ `portraits.json`

```json
{
  "people": {
    "å¼ ä¸‰": {
      "name": "å¼ ä¸‰",
      "aliases": ["è€å¼ "],
      "gender": "ç”·",
      "birthday": "03-15",
      "birthYear": 1990,
      "birthDate": "1990-03-15",
      "address": "åŒ—äº¬å¸‚æœé˜³åŒºxxè·¯xxå·",
      "phone": "+86 138****1234",
      "notes": "å¤§å­¦åŒå­¦ï¼Œåšé‡‘è",
      "updatedAt": "2026-02-05T10:00:00Z",
      "facts": [
        { "key": "å–œå¥½", "value": "å–œæ¬¢é’“é±¼", "source": "2026-01-20 èŠå¤©", "at": "2026-01-20" },
        { "key": "èŒä½", "value": "æŸé“¶è¡Œç»ç†", "source": "2026-01-20", "at": "2026-01-20" }
      ]
    }
  }
}
```

- æ¯æ¬¡ç”¨æˆ·æåŠæŸäººåŠä¸å…¶ç›¸å…³çš„ä¿¡æ¯æ—¶ï¼Œæ›´æ–°å¯¹åº” portraitã€‚
- **gender**ï¼šæ€§åˆ«ï¼ˆç”·/å¥³/å…¶ä»–ï¼‰ã€‚
- **birthday**ï¼š`MM-DD` æ ¼å¼ï¼Œç”¨äºè®°å½•ç”Ÿæ—¥ã€‚
- **birthYear**ï¼šå‡ºç”Ÿå¹´ï¼ˆæ•°å­—ï¼‰ï¼Œå¯é€‰ã€‚
- **birthDate**ï¼šå‡ºç”Ÿæ—¥æœŸï¼Œå¯æ¨¡ç³Šï¼Œå¦‚ `"1990"`ã€`"1990-03"`ã€`"1990-03-15"`ã€‚
- **address**ï¼šå®¶åº­åœ°å€ã€‚
- `facts` ä¸ºé”®å€¼å¯¹åˆ—è¡¨ï¼Œå¯æŒ‰ `key` å»é‡æˆ–è¿½åŠ ï¼ˆåŒä¸€ key ä¿ç•™æœ€æ–°ä¸€æ¡ï¼‰ã€‚

### 1.2 è¿‡å»äº‹ä»¶ `past_events.json`

```json
{
  "events": [
    {
      "id": "evt-001",
      "personIds": ["å¼ ä¸‰", "æå››"],
      "type": "åƒé¥­",
      "date": "2026-01-18",
      "summary": "å’Œå¼ ä¸‰ã€æå››åœ¨æµ·åº•æèšé¤",
      "details": "è®¨è®ºåˆ›ä¸šæƒ³æ³•",
      "createdAt": "2026-02-05T10:00:00Z"
    }
  ]
}
```

- `type`ï¼šåƒé¥­ã€çº¦ä¼šã€æ¸¸ç©ã€èšä¼šã€ä¼šè®®ç­‰ã€‚
- æŸ¥è¯¢æŸäººæ—¶ï¼Œå¯åŸºäº `personIds` è¿‡æ»¤å¹¶è¿”å›ç›¸å…³ past_eventsã€‚

---

## äºŒã€æŠ€èƒ½è¡Œä¸ºæŒ‡å—

### 2.1 ä½•æ—¶è§¦å‘æœ¬ skill

- ç”¨æˆ·æåŠæŸäººåŠä¸å…¶ç›¸å…³çš„ä¿¡æ¯ã€‚
- ç”¨æˆ·è¯´ã€Œè®°ä¸€ä¸‹ã€ã€ŒæŸäººçš„ä¿¡æ¯ã€ã€Œå’ŒæŸäººä¸€èµ·åšè¿‡ä»€ä¹ˆã€ç­‰ã€‚
- ç”¨æˆ·é—®ã€Œæˆ‘å’Œå¼ ä¸‰ä¹‹å‰åšè¿‡ä»€ä¹ˆã€ã€Œå¼ ä¸‰å–œæ¬¢ä»€ä¹ˆã€ç­‰ã€‚

### 2.2 è‚–åƒç»´æŠ¤

- è§£æç”¨æˆ·è¾“å…¥ä¸­çš„äººåã€å±æ€§ï¼ˆå¹´é¾„ã€æ‰‹æœºã€å–œå¥½ç­‰ï¼‰ã€‚
- æ›´æ–° `portraits.json`ï¼šæ–°å»ºæˆ–åˆå¹¶åˆ°å·²æœ‰ portraitï¼Œè¿½åŠ  `facts`ã€‚
- è‹¥äº‹ä»¶å±äºã€Œè¿‡å»ã€ï¼ŒåŒæ—¶å†™å…¥ `past_events.json`ã€‚

### 2.3 è¿‡å»äº‹ä»¶å½’æ¡£

- ç”¨æˆ·æè¿°ã€Œä¸Šå‘¨å’Œè°åƒé¥­ã€ã€Œæ˜¨å¤©å’Œè°çº¦ä¼šã€æ—¶ï¼Œå†™å…¥ `past_events.json`ã€‚
- å…³è” `personIds`ï¼Œä¾¿äºæŒ‰äººæŸ¥è¯¢ã€‚

### 2.4 æŸ¥è¯¢

- ã€Œå¼ ä¸‰çš„ä¿¡æ¯ã€â†’ è¯»å– `portraits.json` ä¸­ `å¼ ä¸‰`ï¼Œå¹¶å¯é€‰æ±‡æ€» `past_events` ä¸­ä¸ä¹‹ç›¸å…³çš„äº‹ä»¶ã€‚
- ã€Œæˆ‘å’Œå¼ ä¸‰ä¸€èµ·åšè¿‡ä»€ä¹ˆã€â†’ æŸ¥è¯¢ `past_events` ä¸­ `personIds` åŒ…å«å¼ ä¸‰çš„äº‹ä»¶ã€‚

---

## ä¸‰ã€é…ç½®

åœ¨ shell æˆ– `~/.openclaw/.env` ä¸­ï¼š

```bash
# æ•°æ®ç›®å½•ï¼ˆå¯é€‰ï¼Œæœªè®¾ç½®æ—¶ä½¿ç”¨ skill/data/ï¼‰
export RELATION_KEEPER_DATA="$HOME/.openclaw/relation-keeper"
```

---

## å››ã€è‡ªç„¶è¯­è¨€è§¦å‘ç¤ºä¾‹

| ç”¨æˆ·è¯´ | æŠ€èƒ½åŠ¨ä½œ |
|--------|----------|
| å¼ ä¸‰ç”Ÿæ—¥ 3 æœˆ 15 å·ï¼Œè®°ä¸€ä¸‹ | æ›´æ–° portrait ç”Ÿæ—¥ |
| ä¸Šå‘¨å’Œå¼ ä¸‰åœ¨æµ·åº•æåƒè¿‡é¥­ | å†™å…¥ past_eventï¼Œæ›´æ–° portrait |
| å¼ ä¸‰å–œæ¬¢é’“é±¼ | æ›´æ–° portrait.facts |
| å¼ ä¸‰çš„ç”µè¯æ˜¯ 138xxxx1234 | æ›´æ–° portrait.phone |
| å¼ ä¸‰æ˜¯ç”·çš„ / å¼ ä¸‰æ€§åˆ« | æ›´æ–° portrait.gender |
| å¼ ä¸‰ 1990 å¹´å‡ºç”Ÿ | æ›´æ–° portrait.birthYear / birthDate |
| å¼ ä¸‰ä½æœé˜³åŒºxxè·¯ | æ›´æ–° portrait.address |
| æˆ‘å’Œå¼ ä¸‰åšè¿‡ä»€ä¹ˆ | æŸ¥ past_eventsï¼Œæ±‡æ€»è¾“å‡º |
| å¼ ä¸‰æ˜¯è° / å¼ ä¸‰çš„ä¿¡æ¯ | è¾“å‡º portrait + ç›¸å…³ past_events æ‘˜è¦ |

> ğŸ’¡ **æé†’åŠŸèƒ½**ï¼šç”Ÿæ—¥ã€çº¦ä¼šç­‰æé†’å»ºè®®ä½¿ç”¨æ—¥å†åº”ç”¨ï¼ˆé£ä¹¦æ—¥å†ã€Google æ—¥å†ç­‰ï¼‰ï¼Œæœ¬ skill ä¸“æ³¨äºè®°å½•å’ŒæŸ¥è¯¢ã€‚

---

## äº”ã€è„šæœ¬ä¸å·¥å…·

ä» skill æ ¹ç›®å½•ï¼ˆ`relation-keeper/`ï¼‰è¿è¡Œï¼Œéœ€ Node.js 16+ï¼š

```bash
# é¦–æ¬¡ä½¿ç”¨ï¼šåˆå§‹åŒ–æ•°æ®ç›®å½•
npm run init

# äººç‰©è‚–åƒ
node scripts/portrait.js get å¼ ä¸‰
node scripts/portrait.js upsert å¼ ä¸‰ --birthday 03-15 --gender ç”· --birthYear 1990 --address "åŒ—äº¬å¸‚æœé˜³åŒºxxè·¯" --fact-key å–œå¥½ --fact-value é’“é±¼

# äº‹ä»¶
node scripts/events.js add --persons å¼ ä¸‰ --type åƒé¥­ --date 2026-01-18 --summary "æµ·åº•æèšé¤"
node scripts/events.js query --person å¼ ä¸‰
```
